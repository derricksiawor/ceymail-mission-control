// CeyMail Mission Control â€” allow ceymail-mc to manage whitelisted mail services
// Install: cp deploy/polkit/45-ceymail-mc.rules /usr/share/polkit-1/rules.d/

polkit.addRule(function(action, subject) {
    var validUnits = [
        "postfix.service",
        "dovecot.service",
        "mariadb.service",
        "opendkim.service",
        "spamassassin.service",
        "apache2.service",
        "unbound.service",
        "rsyslog.service"
    ];

    if (action.id === "org.freedesktop.systemd1.manage-units" &&
        subject.user === "ceymail-mc" &&
        validUnits.indexOf(action.lookup("unit")) >= 0) {
        return polkit.Result.YES;
    }
});
